dist: xenial
language: node_js
node_js:
  - lts/*
cache:
  directories:
    - $HOME/.cache/pip
    - .cache
    - node_modules
    - public
notifications:
  email:
    on_success: change
    on_failure: change
git:
  depth: 1
before_install: npm i -g npm@latest
install: npm i
before_script: npm run build
script: npm test
before_deploy: pip install --user awscli
deploy:
  provider: script
  script: npm run deploy:production
  skip_cleanup: true
  on:
    repo: smockle/smockle.com
    branch: master
